<!doctype html>

<!-- see UNLICENSE file in the website's source code for copyright and license details. -->

<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta name="darkreader-lock">
	<title>The Banguage Dictionary Nth Edition</title>
	<style>
		* {
			font-family: "JetBrains Mono", monospace;
			font-optical-sizing: auto;
			font-weight: 400;
			font-style: normal;
			font-variant-ligatures: none;
			border-radius: 1rem;
		}

		html {
			background-color: #11111b;
			color: #cdd6f4;
		}

		.search {
			display: block;
			margin-left: auto;
			margin-right: auto;
			width: 90%;
			background-color: #11111b;
			border: 4px solid #cdd6f4;

			text-align: center;
			color: #cdd6f4;
		}

		.lvdst {
			width: 20%;
			background-color: #11111b;
			border: 2px solid #cdd6f4;

			color: #cdd6f4;
		}

		.inline {
			display: inline;
		}

		ol {
			display: inline;
		}

		li {
			margin-left: 2em;
			padding-left: 0.5em;
		}

		i {
			font-style: italic;
		}

		.subtext {
			color: #a6adc8;
			opacity: 0.8;
		}

		.greyout {
			text-decoration: line-through;
			color: #a6adc8;
			opacity: 0.6;
		}

		.container-parent {
			display: flex;
		}

		.container {
			background-color: #181825;
			border: 4px solid #cdd6f4;
			margin-top: 2vh;
			padding-top: 1vh;
			padding-left: 2vh;
			padding-right: 2vh;
			min-height: 94vh;
			height: 94vh;
			vertical-align: top;
		}

		.container-left {
			flex: 0.2;
			margin-left: 2vh;
		}

		/* jank to make the scrollbar background not clip the border */
		.container-right-wrapper {
			flex: 0.8;
			padding-left: 3vh;
			margin-left: 2vh;
			margin-right: 2vh;
			padding-right: 0;

			overflow: hidden;
			display: flex;
			flex-direction: column;
		}

		.container-right {
			overflow-y: scroll;
			scrollbar-color: #cdd6f4 #181825;
			flex-grow: 1;

			border-radius: 0;
		}

		/* todo: add hover effects for both entry and def */

		.entry {
			padding: 1vh;
		}

		.entry:hover {
			/* todo: replace with actual colors from the palette when i have
			 * internet */
			background-color: #1e1e2e;
		}
		
		.def {
			border-radius: 0.5rem;
		}

		.def:hover {
			background-color: #313244;
		}

		.collapsed {
			display: none;
		}
	</style>
</head>

<body>
	<div class="container-parent">
		<div class="container container-left">
			<input type="text" class="search" id="search" name="search" placeholder="words/defs or #tags..."
				autocomplete="off">

			<br>
			<p class="inline">search for:</p><br>
			<input type="radio" id="searchmode_words" name="searchmode" checked onclick="setsearchmode('words')"
				autocomplete="off">
			<label for="searchmode_words">words</label><br>
			<input type="radio" id="searchmode_defs" name="searchmode" onclick="setsearchmode('defs')"
				autocomplete="off">
			<label for="searchmode_defs">word definitions</label><br>

			<br>
			<p class="inline">word/definition matching mode:</p><br>
			<input type="radio" id="wmatchmode_plain" name="wmatchmode" checked onclick="setwmmode('plain')"
				autocomplete="off">
			<label for="matchmode_plain">plain</label><br>
			<input type="radio" id="wmatchmode_exact" name="wmatchmode" onclick="setwmmode('exact')" autocomplete="off">
			<label for="matchmode_exact">exact</label><br>
			<input type="radio" id="wmatchmode_regex" name="wmatchmode" onclick="setwmmode('regex')" autocomplete="off">
			<label for="matchmode_regex">regex</label><br>
			<input type="radio" id="wmatchmode_levenshtein" name="wmatchmode" onclick="setwmmode('levenshtein')"
				autocomplete="off">
			<label for="matchmode_levenshtein">levenshtein distance &lt;=</label>
			<input type="number" class="lvdst" id="lvdst" name="lvdst" placeholder="1" autocomplete="off">
		</div>
		<div class="container container-right-wrapper">
			<div class="container-right" id="main">
				<p>if you're reading this, something went wrong (or maybe the page just hasn't loaded?)</p>
			</div>
		</div>
	</div>
	<script>
			// START OF AUTO-GENERATED CODE REGION
const wordlist = ["aff","aippe","ajı","ajpe","ajta","akej","akka","akosa","akupo","al","alla","ame","amu","ani","anipa","anpa","apai","asai","blijap","cama","eka","eni","gama","gatta","goaorks","haj","ħaru","hima","ica","ie","ija","iku","ila","ime","ini","ino","iri","isa","issa","jei","ka","kajo","kála","kami","kani","kata","kígi","kiki","kimari","kowun","kura","lakjo","le","liwa","lo","ma","maja","mama","máma","mi","mika","mjaw","moe","mono","mori","mroje","mrojin","mrow","mu","munā","noj","ola","ölu","omi","osura","osuro","otsı","pajtı","pana","papa","pápa","patsa","pawa","pi","pika","po","ri","sa","sajáwa","sha","shalı","sila","sinō","soji","sona","sosoe","ta","tā","taja","tajama","tako","tali","tamu","tawa","tema","tikka","trune","tsajı","va","val","vi","vir","viru","wajo","wakke","wali","wappe","wawa","womi","wupo","wzow"];
const desclist = [["int","noun","verb intrans"],["noun"],["noun u-uncnt","adj"],["noun","noun","noun, colloquial, rude"],["adj","noun uncnt","noun uncnt, colloquial","adj, colloquial"],["adj"],["int, greeting"],["int, greeting"],["adj","noun uncnt","noun, slang"],["conj"],["prep"],["noun"],["noun","noun","verb"],["noun"],["noun"],["noun"],["noun"],["verb"],["noun","noun","noun, euphemism"],["noun","verb"],["verb","verb"],["verb","verb, colloquial","verb, slang"],["noun uncnt","int","adj, colloquial"],["verb","verb"],["noun/adj"],["int, greeting, loanword"],["verb, colloquial"],["verb vom intrans"],["noun uncnt"],["noun, loanword"],["verb vom intrans","verb vom","verb vom intrans"],["noun uncnt","noun","adj"],["verb"],["conj"],["noun u-uncnt"],["verb vom intrans"],["noun","noun"],["verb","verb, archaic"],["adj","noun uncnt","noun, euphemism","verb intrans, euphemism"],["verb","noun"],["prep"],["verb","verb"],["verb","noun","noun"],["verb"],["noun"],["verb","verb"],["noun"],["noun"],["noun uncnt"],["adj","noun uncnt","noun","noun uncnt","adj, fixed expr."],["noun, formal","noun, colloquial, derogatory"],["adj","noun uncnt","noun, slang"],["prep"],["noun uncnt","noun","noun, colloquial"],["prep","prep"],["particle","abbr","int"],["noun","noun"],["noun"],["noun, formal"],["verb","int resp. part."],["adj","noun uncnt","noun uncnt, archaic/poetic"],["int","noun","verb intrans"],["noun","noun"],["noun","verb intrans"],["verb intrans, loanword"],["int, sometimes childish","int","alt. form"],["noun","adj","noun, colloquial","noun/adj, slang"],["noun","noun","adj","noun","adv, colloquial"],["prep"],["noun"],["noun u-uncnt","noun"],["noun","noun","noun dim.f","adj"],["noun","noun"],["noun uncnt"],["verb","verb"],["verb"],["verb","verb"],["verb","verb"],["adj","noun uncnt","noun","noun uncnt, colloquial","noun/adj, slang","adv, slang"],["noun","noun, mildly archaic"],["noun, formal"],["noun","verb intrans"],["int, greeting"],["prep","prep"],["noun","noun dim.f"],["article"],["prep"],["verb","int resp. part.","int"],["noun","noun, colloquial"],["verb"],["adj","noun uncnt","noun u-uncnt, childish","noun, slang","noun, slang, derogatory"],["noun"],["noun, scientific"],["verb","noun, colloquial"],["noun"],["noun, colloquial","noun, slang","noun, archaic","noun, archaic","noun"],["adj"],["int"],["intrr pronoun"],["intrr pronoun"],["intrr pronoun"],["intrr"],["intrr"],["intrr"],["noun uncnt","noun"],["noun","noun, colloquial"],["noun/adj"],["noun","adj, colloquial","noun, technical"],["prep"],["verb"],["prep"],["alt. form"],["verb","verb","noun, archaic/poetic"],["verb"],["noun"],["noun"],["noun"],["int, greeting","noun, slang"],["verb"],["noun"],["noun u-uncnt/adj/verb"]];
const deflist = [["used to indicate the characteristic vocalization of a dog","the characteristic vocalization of a dog","to make the characteristic vocalization of a dog"],["morning"],["rain","rainy"],["flower","affectionate term of address; darling; sunshine","sarcastic subversion of aforementioned term of address, usually said with an exaggerated/over-the-top \"cutesy\" tone."],["green","greenness","riches","young, inexperienced, hopeful in a naive manner"],["kind; polite; generous"],["shortening of <i>akosa</i>. something like \"hii\" or \"sup\"."],["general-purpose greeting, similar to \"hello\", suitable for polite/formal contexts."],["blue","blueness","cop; usually in a derogatory manner"],["or"],["via"],["voice; sound uttered by the mouth, esp. by humans in speech/song"],["the moon (not just the moon itself, but also the cultural object; the force turning werewolves into their animal forms; the foundation of ancient timekeeping systems)","month","to comfort someone"],["child"],["day (the time of day between morning and evening)"],["day (the entire day, not the time of day)"],["time of day"],["to kill"],["destination","place of meeting","death; last day"],["decision","to decide"],["to add to something","to create"],["to join","to connect with someone; be that romantically or platonically","to \"hop on\""],["bread","mmm! / tasty! (the <i>m</i> and <i>a</i> sounds at the end are typically elongated)","tasty"],["to steal","to steal and give to <someone/something>"],["<br><img src=\"media/goaorks.png\" width=\"80%\">"],["\"hi\". Borrowed from English <i>hi</i>."],["to eat; to devour; to gobble. Has a greedy / animalistic / sometimes negative connotation.<br><i>Pronunciation notes: May be pronounced haru by some speakers. This is non-standard.</i>"],["to come"],["blood"],["house; home; residence; dwelling. Borrowed from Japanese 家 (いえ)."],["to jump","to cross an obstacle","to move very fast"],["water","source of drinkable water","thirsty"],["an emphatic form of <i>womi</i>; to love (as in \"I'd love to talk to you guys more\", not as in \"I love you\")"],["and"],["stuff; miscellaneous, unspecified, or nondescript items, objects, things, or matters"],["to go"],["the sun (also the cultural object; the thing giving life to Earth; the thing represented by all the ancient solar deities)","hot day"],["to touch","to kill"],["red","redness","bleeding; injury","to bleed"],["to say","saying"],["in"],["to have","to own"],["to leave behind","orphan","reject; exile"],["to eat"],["adult"],["to take","to take and give to <someone/something>"],["cat"],["smth. like \"mom\"/\"dad\", but gender-neutral"],["intelligence; capacity of mind"],["black","blackness","shadow","ash","part of the fixed expression <i>kowun amu</i> (new moon)"],["parent","parent that has become distant from their child(ren) and doesn't talk to them anymore, usually because said child(ren) don't want to talk to them."],["orange","orangeness","red flag"],["around/round"],["time; the inevitable progression into the future, the passing of the present","clock","deadline"],["below","under"],["added to the end of a sentence to form a question","abbreviation of <i>sa ma</i>","(usually spoken with a questioning, rising tone) is it so?"],["person","human being"],["mom"],["mother"],["negative form of <i>sa</i> (formerly an abbreviation of <i>sa'mi</i>)","no (responding to a yes/no question)"],["yellow","yellowness","sunlight"],["used to indicate the characteristic vocalization of a cat","the characteristic vocalization of a cat","to make the characteristic vocalization of a cat"],["world","realm; dimension (not as in the measure of spatial extent)"],["rot; decay","to rot; to decay; to collapse into ruin"],["to die; be slain; fall (in battle); perish. Borrowed from Latin <i>morī</i>."],["used to point out someone making a trivial mistake","used in online texting when someone makes a typo; usually in a joking manner","archaic form of <strong>mrojin</strong>"],["code; cipher","mysterious","typo, especially on the Internet","someone who makes typos frequently"],["length","distance","long","emotional distance","slothily; with notable sluggishness"],["at"],["a lot; a large amount"],["wind","resistance, obstacle"],["light source","lamp","(in diminutive form) lightbulb","glowing"],["city","some place with a large amount of things related to something"],["music"],["to need; to have an absolute requirement for","to need; to want strongly; to feel that one must have something"],["to want"],["to see","to look"],["to hear","to listen to"],["white","whiteness","pile of snow","dandruff","coward; pussy","in an over-the-top cautious way"],["dad","formerly used by younger men to show respect towards elderly men; now falling out of use"],["father"],["existence","to exist"],["casual \"morning!\"."],["above","over"],["fork (pronged tool)","(in diminutive form) fork (kitchen utensil)"],["optional definite article"],["on"],["to be (describing action or state of being)<br><i>Note: irregular negative form 'mi', see entry<br>Note: irregular past tense 'sap'</i>","yes (responding to a yes/no question)","making an acknowledgement or showing agreement, like \"mhm\""],["leaf","(usually derogatory towards the parent) child of someone with a very large amount of children"],["to be (equating something to a noun)<br><i>Note: irregular negative form 'shu'</i>"],["brown","brownness","poop","shitstain","person obsessed with living \"naturally\" or \"off-grid\""],["star (the cultural object; what sailors used to rely on to find their way back home; what you see, laying on the ground looking into the night sky)"],["star (the luminous plasmic spheroidal astronomical object)"],["to look like; to resemble","copycat"],["portion"],["multiplayer video game lobby<br><i>Etymology note: stems from the fact that early RPGs with online multiplayer capabilities called lobbies \"worlds\", using the archaic term to invoke a feeling of importance / mysticality / \"RPG-ness\". Now considered cliché, but the term has stuck around and is now just a word for a multiplayer video game lobby.</i>","social media in-group/community<br><i>Etymology note: origins questioned but likely stemming from jokingly referring to online communities as \"lobbies\"</i>","world","realm; dimension (not as in the measure of spatial extent)","motherland; homeland. Has a patriotic connotation."],["\"my\". Only used in very specific contexts due to, among other things, possible confusion; typically <i>koj'tä</i> should be used instead."],["\"um…\", \"uh…\", \"so…\". The <i>a</i> sound can be made arbitrarily long."],["who"],["whose"],["which"],["why"],["where"],["when"],["food; any solid substance consumable (esp. by eating) to sustain life","foodstuff"],["center","capital city"],["\"slur against fish\"."],["tree","always holding steady ground onto their values/beliefs/hopes/etc.","tree (data structure)"],["as"],["to let"],["to"],["archaic form of <strong>ajï</strong>. Has a more stormy, harsh, \"force of nature\" connotation."],["to give","to gift","gift; blessing"],["to drink"],["night"],["elderly person"],["evening"],["intentional silly-fication or \"cute version\" of <i>pawa</i>.","\"silly/cute version\" of <i>aippe</i>."],["to like"],["song; a piece of music"],["<br><img src=\"media/wzow.png\" width=\"50%\"><br><i>Pronunciation notes: may be pronounced wzaw / wzäw by some speakers. This is non-standard.</i>"]];
const taglist = [[["interjection","onomatopoeia"],["noun","physicalnoun","onomatopoeia"],["verb","intransitiveverb","onomatopoeia"]],[["noun","physicalnoun","commonword","time"]],[["noun","u-uncountable","physicalnoun","commonword","weather"],["adjective","commonword","weather"]],[["noun","physicalnoun","commonword","nature"],["noun","physicalnoun","commonword","affectionate"],["noun","physicalnoun","informal","rude"]],[["adjective","commonword","color"],["noun","uncountable","abstractnoun","commonword","color"],["noun","uncountable","physicalnoun","informal"],["adjective"]],[["adjective","commonword"]],[["interjection","commonword","informal"]],[["interjection","commonword"]],[["adjective","commonword","color"],["noun","uncountable","abstractnoun","commonword","color"],["noun","physicalnoun","informal","rude","derogatory","slang","people"]],[["conjunction","grammar","commonword"]],[["preposition","grammar","commonword"]],[["noun","physicalnoun","commonword"]],[["noun","physicalnoun","commonword","sky"],["noun","abstractnoun","commonword","calendar"],["verb","commonword"]],[["noun","physicalnoun","commonword","person"]],[["noun","physicalnoun","commonword","time"]],[["noun","physicalnoun","commonword","calendar"]],[["noun","abstractnoun","commonword","time"]],[["verb","commonword"]],[["noun","abstractnoun","commonword"],["noun","physicalnoun"],["noun","abstractnoun","euphemism"]],[["noun","abstractnoun","commonword"],["verb","commonword"]],[["verb","commonword"],["verb","commonword"]],[["verb","commonword"],["verb"],["verb","informal","slang","internet"]],[["noun","uncountable","commonword","physicalnoun","food"],["interjection","commonword"],["adjective","commonword"]],[["verb","commonword"],["verb","commonword"]],[["joke/shitpost"]],[["interjection","informal","loanword"]],[["verb","informal","evilalphabet"]],[["verb","intransitiveverb","verbofmotion","commonword"]],[["noun","uncountable","commonword","physicalnoun"]],[["noun","physicalnoun","commonword","loanword"]],[["verb","intransitiveverb","verbofmotion","commonword"],["verb","verbofmotion","commonword"],["verb","intransitiveverb","verbofmotion"]],[["noun","uncountable","physicalnoun","commonword","drink"],["noun","physicalnoun","commonword"],["adjective","commonword"]],[["verb","commonword"]],[["conjunction","grammar","commonword"]],[["noun","u-uncountable","physicalnoun","commonword","informal"]],[["verb","intransitiveverb","verbofmotion","commonword"]],[["noun","physicalnoun","commonword","sky"],["noun","physicalnoun","commonword","weather"]],[["verb","commonword"],["verb","archaic"]],[["adjective","commonword","color"],["noun","uncountable","abstractnoun","commonword","color"],["noun","physicalnoun","euphemism"],["verb","intransitiveverb","euphemism"]],[["verb","commonword"],["noun","abstractnoun"]],[["preposition","grammar","commonword"]],[["verb","commonword"],["verb","commonword"]],[["verb"],["noun","physicalnoun","person"],["noun","physicalnoun","person"]],[["verb","commonword"]],[["noun","physicalnoun","commonword","person"]],[["verb","commonword"],["verb","commonword"]],[["noun","physicalnoun","commonword","animal","pet"]],[["noun","physicalnoun","commonword","person"]],[["noun","uncountable","abstractnoun","commonword"]],[["adjective","commonword","color"],["noun","uncountable","abstractnoun","commonword","color"],["noun","physicalnoun","commonword"],["noun","uncountable","physicalnoun","commonword"],["adjective","fixedexpression"]],[["noun","physicalnoun","commonword","formal","person"],["noun","physicalnoun","informal","rude","derogatory","person"]],[["adjective","commonword","color"],["noun","uncountable","abstractnoun","commonword","color"],["noun","abstractnoun","informal","slang"]],[["preposition","grammar","commonword"]],[["noun","uncountable","abstractnoun","commonword"],["noun","physicalnoun","commonword"],["noun","abstractnoun"]],[["preposition","grammar","commonword"],["preposition","grammar","commonword"]],[["particle","commonword"],["abbreviation","commonword"],["interjection","commonword"]],[["noun","physicalnoun","commonword","person"],["noun","physicalnoun","commonword","person"]],[["noun","physicalnoun","gendered","commonword","person"]],[["noun","physicalnoun","gendered","commonword","formal","person"]],[["verb","irregularverb","commonword"],["interjection","responseparticle","commonword"]],[["adjective","commonword","color"],["noun","uncountable","abstractnoun","commonword","color"],["noun","uncountable","physicalnoun","archaic","poetic"]],[["interjection","onomatopoeia"],["noun","physicalnoun","onomatopoeia"],["verb","intransitiveverb","onomatopoeia"]],[["noun","physicalnoun","commonword"],["noun","physicalnoun","commonword"]],[["noun","abstractnoun","commonword"],["verb","intransitiveverb","commonword"]],[["verb","intransitiveverb","commonword","loanword"]],[["interjection","informal"],["interjection","informal","internet"],["altform","archaic"]],[["noun","abstractnoun","commonword"],["adjective","commonword"],["noun","abstractnoun","commonword","internet"],["noun","physicalnoun","adjective","informal","slang","internet"]],[["noun","abstractnoun","commonword"],["noun","abstractnoun","commonword"],["adjective","commonword"],["noun","abstractnoun"],["adverb","informal"]],[["preposition","grammar","commonword"]],[["noun","abstractnoun","quantity","commonword"]],[["noun","u-uncountable","physicalnoun","commonword","weather"],["noun","physicalnoun","commonword"]],[["noun","physicalnoun","commonword"],["noun","physicalnoun","commonword"],["noun","diminutiveform","physicalnoun","commonword"],["adjective","commonword"]],[["noun","physicalnoun","commonword"],["noun","physicalnoun"]],[["noun","uncountable","physicalnoun","commonword"]],[["verb","commonword"],["verb","commonword"]],[["verb","commonword"]],[["verb","commonword"],["verb","commonword"]],[["verb","commonword"],["verb","commonword"]],[["adjective","commonword","color"],["noun","uncountable","abstractnoun","commonword","color"],["noun","physicalnoun"],["noun","uncountable","physicalnoun","informal"],["noun","physicalnoun","adjective","informal","rude","slang","people"],["adverb","informal","slang"]],[["noun","physicalnoun","gendered","commonword","person"],["noun","physicalnoun","gendered","archaic","person"]],[["noun","physicalnoun","gendered","commonword","formal","person"]],[["noun","abstractnoun","commonword"],["verb","intransitiveverb","commonword"]],[["interjection","commonword","informal"]],[["preposition","grammar","commonword"],["preposition","grammar","commonword"]],[["noun","physicalnoun","commonword"],["noun","diminutiveform","physicalnoun","commonword"]],[["article","grammar","commonword"]],[["preposition","grammar","commonword"]],[["verb","irregularverb","commonword"],["interjection","responseparticle","commonword"],["interjection","commonword"]],[["noun","physicalnoun","commonword","nature"],["noun","physicalnoun","informal","rude","derogatory"]],[["verb","irregularverb","commonword"]],[["adjective","commonword","color"],["noun","uncountable","abstractnoun","commonword","color"],["noun","u-uncountable","physicalnoun","childish"],["noun","physicalnoun","informal","rude","slang"],["noun","physicalnoun","informal","rude","derogatory","slang","people"]],[["noun","physicalnoun","commonword","sky"]],[["noun","physicalnoun","formal","scientific","sky"]],[["verb","commonword"],["noun","physicalnoun"]],[["noun","abstractnoun","commonword"]],[["noun","physicalnoun","internet"],["noun","physicalnoun","slang","internet"],["noun","physicalnoun","archaic"],["noun","physicalnoun","archaic"],["noun","physicalnoun"]],[["adjective","commonword"]],[["interjection","commonword","filler"]],[["interrogative","pronoun","commonword"]],[["interrogative","pronoun","commonword"]],[["interrogative","pronoun","commonword"]],[["interrogative","commonword"]],[["interrogative","commonword"]],[["interrogative","commonword"]],[["noun","uncountable","physicalnoun","commonword","food"],["noun","physicalnoun","commonword","food"]],[["noun","abstractnoun","commonword"],["noun","physicalnoun","commonword"]],[["joke/shitpost"]],[["noun","physicalnoun","commonword","nature"],["adjective"],["noun","abstractnoun","technical"]],[["preposition","grammar","commonword"]],[["verb","commonword"]],[["preposition","grammar","commonword"]],[["altform","archaic","weather"]],[["verb","commonword"],["verb","commonword"],["noun","abstractnoun","archaic","poetic"]],[["verb","commonword"]],[["noun","physicalnoun","commonword","time"]],[["noun","physicalnoun","commonword","person"]],[["noun","physicalnoun","commonword","time"]],[["interjection","informal","cutesy"],["noun","abstractnoun","informal","slang","cutesy"]],[["verb","commonword"]],[["noun","physicalnoun","commonword"]],[["joke/shitpost"]]];

// END OF AUTO-GENERATED CODE REGION

let searchbar = document.getElementById("search");
let lvdstbox = document.getElementById("lvdst");
let hide_tags = false;

// valid values: "plain", "exact", "regex", "levenshtein"
let wmatchmode = "plain";

// valid values: "words", "defs"
let searchmode = "words";

function levenshtein(x, y) {
	if (!x.length) return y.length;
	if (!y.length) return x.length;
	const arr = [];
	for (let i = 0; i <= y.length; i++) {
		arr[i] = [i];
		for (let j = 1; j <= x.length; j++) {
			arr[i][j] = i === 0 ? j : Math.min(
				arr[i - 1][j] + 1,
				arr[i][j - 1] + 1,
				arr[i - 1][j - 1] + (x[j - 1] === y[i - 1] ? 0 : 1)
			);
		}
	}
	return arr[y.length][x.length];
}

function match(x, y) {
	switch (wmatchmode) {
		case "plain": return y.includes(x);
		case "exact": return x === y;
		case "regex": return new RegExp(x).test(y);
		case "levenshtein": return levenshtein(x, y) <= lvdstbox.value;
	}
}

function shouldDisplayWord(input, word, defs, alltags) {
	const searchfortags = input.includes("#");

	// split at spaces except inside single quotes
	let terms = input.match(/(?:[^\s']+|'[^']*')+/g);
	terms.forEach((item, idx) => (terms[idx] = item.replaceAll("'", ""))); // remove single quotes

	let matchedword = false;
	let matcheddef = [];
	let matchedtags = [];
	let tagsonly = true;
	terms.forEach(function(item) {
		if (item[0] !== "#") {
			tagsonly = false;
			switch (searchmode) {
				case "words":
					if (match(item, word))
						matchedword = true;
					break;
				case "defs":
					defs.forEach(function(def, idx) {
						if (match(item, def))
							matcheddef.push(idx);
					});
			}
		} else {
			alltags.forEach(function(tags, idx) {
				if (tags.includes(item.slice(1)))
					matchedtags.push(idx);
			});
		}
	});
	if (tagsonly && matchedtags.length > 0)
		return true;
	let gottags = (!searchfortags || matchedtags.length > 0);
	let gotdef = (!searchfortags && matcheddef.length > 0) || matcheddef.some(e => matchedtags.includes(e));
	return gottags && (matchedword || gotdef);
}

function shouldDisplayDef(input, tags, def) {
	const searchfortags = input.includes("#");
	if (!searchfortags && searchmode !== "defs") // don't need to do anything
		return true;

	// split at spaces except inside single quotes
	let terms = input.match(/(?:[^\s']+|'[^']*')+/g);
	terms.forEach((item, idx) => (terms[idx] = item.replaceAll("'", ""))); // remove single quotes

	let matchedtags = false;
	let matcheddef = false;
	let tagsonly = true;
	terms.forEach(function(item) {
		if (item[0] === "#" && tags.includes(item.slice(1))) {
			matchedtags = true;
		} else if (item[0] !== "#") {
			tagsonly = false;
			if (searchmode === "defs" && match(item, def))
				matcheddef = true;
		}
	});
	return ((!searchfortags || matchedtags) && (tagsonly || (searchmode !== "defs" || matcheddef)));
}

function redraw(wordDisplayCallback, defDisplayCallback) {
	let mainarea = document.getElementById("main");
	mainarea.textContent = ""; // clear all children
	wordlist.forEach(function(item, idx) {
		if (wordDisplayCallback(item, deflist[idx], taglist[idx])) {
			word_div = mainarea.insertAdjacentElement("beforeend", document.createElement("div"));
			word_div.classList.add("entry");
			word_div.insertAdjacentHTML("beforeend", "<h3 class=\"inline word\"><strong>" + item + "</strong></h3> ");
			defs_div = word_div.insertAdjacentElement("beforeend", document.createElement("div"));
			defs_div.classList.add("defs");
			desclist[idx].forEach(function(subitem, subidx) {
				let x = defDisplayCallback(taglist[idx][subidx], deflist[idx][subidx]) ? "" : " class=\"greyout\"";
				// this line is 239 cols long :face_holding_back_tears:
				defs_div.insertAdjacentHTML("beforeend", "<li class=\"def\"" + x + "><i>" + subitem + "</i> " + deflist[idx][subidx] + (!hide_tags ? ("<br><p class=\"inline subtext\">tags: " + taglist[idx][subidx].join(" ") + "</p>") : "") + "</li>");
			});
		}
	});

	for (let word of document.getElementsByClassName("word")) {
		word.addEventListener("click", _ => {
			// todo: add some sort of indicator that the word is collapsed
			// like a chevron or something idk
			let defs = word.nextElementSibling;
			defs.classList.toggle("collapsed");
		});
	}

	// todo: when clicking on a def, copy it

	// for (let def of document.getElementsByClassName("def")) {
	// 	def.addEventListener("click", _ => {
	//
	// 	});
	// }
}

function refresh(input) {
	if (input === "")
		redraw(_ => true, _ => true);
	else
		redraw((word, defs, alltags) => shouldDisplayWord(input, word, defs, alltags),
			(tags, def) => shouldDisplayDef(input, tags, def));
}

function setwmmode(wmmode) {
	wmatchmode = wmmode;
	refresh(searchbar.value);
}

function setsearchmode(smode) {
	searchmode = smode;
	refresh(searchbar.value);
}

searchbar.addEventListener("input", (e) => refresh(e.target.value));
lvdstbox.addEventListener("input", _ => refresh(searchbar.value));
document.addEventListener("keypress", (e) => {
	if (e.code == "KeyH") { // h
		hide_tags = !hide_tags;
		refresh(searchbar.value);
	}
});

redraw(_ => true, _ => true);
		</script>
	</body>
</html>
